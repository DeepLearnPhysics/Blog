
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="http://deeplearnphysics.org/Blog/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://deeplearnphysics.org/Blog/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://deeplearnphysics.org/Blog/theme/font-awesome/css/font-awesome.min.css">




  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Kazuhiro Terao" />
<meta name="description" content="Scalable deep learning for high resolution particle imaging detectors is here!" />
<meta name="keywords" content="news, paper">
<meta property="og:site_name" content="DeepLearnPhysics Blog"/>
<meta property="og:title" content="Sparse Submanifold Convolutional Neural-Network (SSCN)"/>
<meta property="og:description" content="Scalable deep learning for high resolution particle imaging detectors is here!"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://deeplearnphysics.org/Blog/2019-03-14-SSCN-at-ACAT2019.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-03-14 00:00:00-05:00"/>
<meta property="article:modified_time" content="2019-03-14 00:00:00-05:00"/>
<meta property="article:author" content="http://deeplearnphysics.org/Blog/author/kazuhiro-terao.html">
<meta property="article:section" content="news"/>
<meta property="article:tag" content="news"/>
<meta property="article:tag" content="paper"/>
<meta property="og:image" content="profile.png">


<!-- Default meta cards for twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@dlphysics">
<meta name="twitter:creator" content="@dlphysics">
<meta name="twitter:title" content="Sparse Submanifold Convolutional Neural-Network (SSCN)">
<meta name="twitter:description" content="<p>Scalable deep learning for high resolution particle imaging detectors is here!</p>">
<meta name="twitter:image" content="http://deeplearnphysics.org/Blog/theme/img/profile_small.png" />


  <title>DeepLearnPhysics Blog &ndash; Sparse Submanifold Convolutional Neural-Network (SSCN)</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://deeplearnphysics.org/Blog">
        <img src="http://deeplearnphysics.org/Blog/theme/img/profile.png" alt="Blog" title="Blog">
      </a>
      <h1><a href="http://deeplearnphysics.org/Blog">Blog</a></h1>

<p>DeepLearnPhysics Group</p>

      <ul class="social">
        <li><a class="sc-home" href="http://deeplearnphysics.org" target="_blank"><i class="fa fa-home"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/dlphysics" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-github" href="http://github.com/DeepLearnPhysics" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>

  </aside>
  <main>
    <nav>


      <a href="http://deeplearnphysics.org/Blog/index.html">Home</a>
      <a href="http://deeplearnphysics.org/Blog/categories.html">Category</a>
      <a href="http://deeplearnphysics.org/Blog/archives.html">Archives</a>
      <a href="http://deeplearnphysics.org/Blog/tags.html">Tags</a>
      <a href="http://deeplearnphysics.org/Blog/authors.html">Authors</a>


    </nav>

<article class="single">
  <header>
    <h1 id="2019-03-14-SSCN-at-ACAT2019">Sparse Submanifold Convolutional Neural-Network (SSCN)</h1>
    <p>
          Posted on Thu 14 March 2019 in <a href="http://deeplearnphysics.org/Blog/category/news.html">news</a>

            by

              <a href="http://deeplearnphysics.org/Blog/author/kazuhiro-terao.html">Kazuhiro Terao</a>    </p>
  </header>

  <!-- script is a local library -->
  <link rel="stylesheet" type="text/css" href="http://deeplearnphysics.org/Blog/theme/stylesheet/kazunotebook.css">

  <div>
    <h2>ACAT 2019 Conference</h2>
<p>We just attended <a href="https://indico.cern.ch/event/708041/overview">ACAT2019</a> conference at Saas-Fee, Switzerland.</p>
<p>Yes, skiing there was awesome.</p>
<p>But the conference was also lots of fun: mainly LHC physicists but also some diversity: we saw <a href="https://scholar.google.com/citations?user=LEcRNrMAAAAJ&amp;hl=en">Daniel</a> from SLAC, <a href="https://scholar.google.com/citations?user=UGlyhFMAAAAJ&amp;hl=en">Danilo</a> from Google DeepMind (an inventor of VAE!) and <a href="https://research.fb.com/people/chintala-soumith/">Soumith</a> from Facebook AI Research (yes, who answered your pytorch question). Take a look at all talks posted on the <a href="https://indico.cern.ch/event/708041/overview">website</a>!</p>
<p><strong>Laura</strong> gave a talk about her <a href="https://arxiv.org/abs/1903.05663">recently published paper</a> about applying <a href="https://github.com/facebookresearch/SparseConvNet">Sparse Submanifold Convolutional Neural Networks (SCN)</a> on a high resolution 3D particle images from our newly made <a href="https://osf.io/vruzp/">open data</a>. SCN is a way to address scalability challenge of applying CNNs on a large-scale particle imaging detectors, such as liquid argon time projection chamber (LArTPC) experiments including SBN program and DUNE. We summarize Laura's work below on this topic.</p>
<h2>Sparse Submanifold Convolution</h2>
<p>Convolutional neural networks (CNNs) are great for image analysis. There are two challenges in applying CNNs for scientific imaging data.</p>
<ol>
<li>Lots of image data in science are sparse, carrying null-pixels with no information.</li>
<li>Data is big: imaging hardwares continue to advance, producing giga-pixel images at high rate.</li>
</ol>
<p>A big data mostly filled with zero causes two issues to apply CNNs: wasted computational resource and degradation of performance. In photographs, for which CNNs are originally developed, there are no useless pixels. The fact that we see blue sky in the background of a flying bird helps us to identify the subject as a bird.</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineSparseExample.png" title="Sparse Example" style="width:95%">
</figure>
</center></p>
<h3>SCN for LArTPCs</h3>
<p>SCN addresses these challenge by introducing convolution operations that only take into account for non-zero pixels in the input and feature tensors outputed from the subsequent layers. This avoids waste of computational resource: the resource usage scales <em>almost</em> by the number of non-zero pixels instead of the total number of pixels in the volume. Yet, the convolution operations remains the same to effectively learn topological features of the object in the space.</p>
<p>This is particularly powerful for LArTPCs which data is generally sparse but locally dense (i.e. particle trajectories have no gap). Because of locally dense nature, down-sampling operations are known to hurt the performance of an algorithm for LArTPC data. Yet, particle trajectories are mostly 1D lines and result in lots of null-pixels when represented in 2D/3D images.</p>
<h3>3D SCM for LArTPCs</h3>
<p>Due to the issues discussed above, analyzing 3D particle images using a dense (i.e. standard) CNN has been almost impossible before SCN. In the paper, Laura used <a href="https://arxiv.org/abs/1808.07269">U-ResNet</a> architecture to apply SCN for 3D semantic segmentation of five particle types using our <a href="https://osf.io/vruzp">open data</a>.</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineUResNet.png" title="U-ResNet" style="width:100%">
</figure>
</center></p>
<p>Here's a result of a comparison study for the computational resource cost between the dense CNN vs. SCN</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineSSCNResource.png" title="SSCN Resource Comparison" style="width:65%">
</figure>
</center></p>
<p>... yep, we could run SCN even on CPU and it's not so bad actually. Here's another way to look at this: how much memory is required to process a chunk of image data at once? Although the paper does not report a study using a large detector image, a relevant question is how many images can we stuck in a mini-batch to process using a GPU at a time.</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineSSCNResource2.png" title="SSCN Resource Comparison" style="width:70%">
</figure>
</center></p>
<p>We see that SCN version can handle the numbr of pixels equivalent to the whole MicroBooNE detector at less than 1GB memory usage. The ICARUS data, x6 larger than MicroBooNE, can easily fit in a conventional GPU card. Moreover, because the resource usage scale with non-zero pixel counts, x1000 times larger DUNE far detector (10kton, compared to roughly 100ton of MicroBooNE) can fit with less resource usage (both MicroBooNE and ICARUS have lots of cosmic-ray particles passing through as the detectors are on the surface). The SCN will be an ideal solution for DUNE near detector which will contain comparable number of particles tracks to MicroBooNE and ICARUS.</p>
<h3>Reconstruction of Michel Electrons</h3>
<p>The perforamnce reported in the paper is great, and five particle segmentation allows us to implement simple yet interesting physics study immediately. In her presentation and the paper, Laura demonstrated a simple DBSCAN algorithm to cluster the primary ionization of a Michel electron, a decay product of a muon. The reason why clustering is limited to the primary ionization part is because radiated gamma-rays are classified as EM-showers in this study. Here's a plot that compares number of pixels reconstructed (i.e. clustered using DBSCAN on U-ResNet output) vs. the number of pixels in the corresponding true cluster.</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineMichelCluster.png" title="Michel Cluster" style="width:80%">
</figure>
</center></p>
<p>It shows a nice linear relationship, with some scattered populations below y=x, which indicates under-clustering due to mistakes by U-ResNet. Laura quantified four performance metrics:
<em> How much fraction of true Michel electrons are reconstructed? (Michel ID efficiency)
</em> How mich fraction of reconstructed Michel electrons are true Michels? (Michel ID purity)
<em> How much fraction of a true Michel electron pixels are clustered in a reconstructed Michel? (Clustering efficiency)
</em> How much fraction of a reconstructed Michel cluster originate from a true Michel electron? (Clustering purity)</p>
<p>... and here's the results:</p>
<p><center>
<figure>
<img src="imgs/2019-03-14-ACATDomineMichel.png" title="Michel Performance" style="width:100%">
</figure>
</center></p>
<p>These numbers are <em>really good</em> compared to some published results from the existing experiment. Quoting one of them, a typical ID efficiency and purity are 2% and 80-90% respectively though we should note typically analysis focuses to make higher purity by sacrificing efficiency for Michel electron reconstruction. Nevertheless, this result is compelling.</p>
<p>The left plot should be taken with a warning: although the x-axis is in MeV scale, the reconstruction does not include energy reconstruciton. The only relevant demonstration here is the performance of clustering, which is considered the most challenging part of Michel energy reconstruction. It is probably better presented in terms of clustered pixel counts instead of MeV. Nevertheless, this is a very promising results.</p>
<h3>Remark</h3>
<p><strong>The <a href="https://arxiv.org/pdf/1903.05663.pdf">paper</a> lists everything you need to reproduce the results</strong> including a software container, open data set link, and our implementation of SCN. The SCN works great for LArTPCs, and should be used in all LArTPC experiments IMO where CNN is employed :)</p>
  </div>

  <div class="tag-cloud">
    <p>
      <a href="http://deeplearnphysics.org/Blog/tag/news.html">news</a>
      <a href="http://deeplearnphysics.org/Blog/tag/paper.html">paper</a>
    </p>
  </div>



</article>

    <footer>
<p>
  &copy; DeepLearnPhysics 2017 - This work is licensed under a <a rel="license" href="https://opensource.org/licenses/MIT">MIT License</a>
</p>
<p>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " DeepLearnPhysics Blog ",
  "url" : "http://deeplearnphysics.org/Blog",
  "image": "profile.png",
  "description": "description!"
}
</script>
</body>
</html>