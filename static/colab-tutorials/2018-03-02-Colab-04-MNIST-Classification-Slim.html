
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="/theme/font-awesome/css/font-awesome.min.css">




  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Kazuhiro Terao" />
<meta name="description" content="/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the …" />
<meta name="keywords" content="colaboratory tensorflow mnist classification slim">
<meta property="og:site_name" content="DeepLearnPhysics Blog"/>
<meta property="og:title" content="High level APIs (Slim)"/>
<meta property="og:description" content="/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/2018-03-02-Colab-04-MNIST-Classification-Slim.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-03-02 00:00:00-06:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/kazuhiro-terao.html">
<meta property="article:section" content="tutorial"/>
<meta property="article:tag" content="colaboratory tensorflow mnist classification slim"/>
<meta property="og:image" content="profile.png">


<!-- Default meta cards for twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@dlphysics">
<meta name="twitter:creator" content="@dlphysics">
<meta name="twitter:title" content="High level APIs (Slim)">
<meta name="twitter:description" content="<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the …</style>">
<meta name="twitter:image" content="/theme/img/profile_small.png" />


  <title>DeepLearnPhysics Blog &ndash; High level APIs (Slim)</title>
</head>
<body>
  <aside>
    <div>
      <a href="">
        <img src="/theme/img/profile.png" alt="Blog" title="Blog">
      </a>
      <h1><a href="">Blog</a></h1>

<p>DeepLearnPhysics Group</p>

      <ul class="social">
        <li><a class="sc-home" href="http://deeplearnphysics.org" target="_blank"><i class="fa fa-home"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/dlphysics" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-github" href="http://github.com/DeepLearnPhysics" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>

  </aside>
  <main>
    <nav>


      <a href="/index.html">Home</a>
      <a href="/categories.html">Category</a>
      <a href="/archives.html">Archives</a>
      <a href="/tags.html">Tags</a>
      <a href="/authors.html">Authors</a>


    </nav>

<article class="single">
  <header>
    <h1 id="2018-03-02-Colab-04-MNIST-Classification-Slim">High level APIs (Slim)</h1>
    <p>
          Posted on Fri 02 March 2018 in <a href="/category/tutorial.html">tutorial</a>

            by

              <a href="/author/kazuhiro-terao.html">Kazuhiro Terao</a>    </p>
  </header>

  <!-- script is a local library -->
  <link rel="stylesheet" type="text/css" href="/theme/stylesheet/kazunotebook.css">

  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tensorflow-Slim">Tensorflow Slim<a class="anchor-link" href="#Tensorflow-Slim">&#182;</a></h1><p>In this notebook we will use tensorflow's high level API (wrapper) module called <code>slim</code> to re-do <a href="http:deeplearnphysics.org/Blog/colab-tutorials/2018-03-02-Colab-02-MNIST-Classification.html">training of CNN for MNIST data set</a>. There is even more popular wrapper called <code>keras</code>. Both toolkits provide simple functions for us to easily build a complex computational graph.</p>
<p>In the previous MNIST example, we defined convolution and fully-connected layers in a pedantic way by defining weights, bias, and even matrix multiplication by hand. It was to see the internal calculation explicitly. But doing so is a) tiring and b) increases a chance of making a mistake. Now that we understand how the internals work, let's use high level APIs.</p>
<h3 id="Preparation?">Preparation?<a class="anchor-link" href="#Preparation?">&#182;</a></h3><p>This notebook is a continuation from <a href="http:deeplearnphysics.org/Blog/colab-tutorials/2018-03-02-Colab-02-MNIST-Classification.html">the last notebook</a>. You can run this notebook on <a href="https://colab.research.google.com">google colaboratory</a> with a free K80 GPU.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Import tensorflow</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="c1"># Import tensorflow&#39;s MNIST data handle</span>
<span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s1">&#39;MNIST_data&#39;</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Extracting MNIST_data/train-images-idx3-ubyte.gz
Extracting MNIST_data/train-labels-idx1-ubyte.gz
Extracting MNIST_data/t10k-images-idx3-ubyte.gz
Extracting MNIST_data/t10k-labels-idx1-ubyte.gz
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-the-network">Define the network<a class="anchor-link" href="#Define-the-network">&#182;</a></h2><p>First, let's define placeholders for input data, labels, and drop-out fraction. This part is identical to the last MNIST training tutorial.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Network inputs</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">):</span>
    <span class="n">images</span>    <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">784</span><span class="p">])</span>
    <span class="n">labels</span>    <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="n">keep_prob</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    
    <span class="n">image2d</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Record a random 10 samples of images in monitoring</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="n">image2d</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Secondly, we define a function to build the network using <code>slim</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow.contrib.slim</span> <span class="kn">as</span> <span class="nn">slim</span>

<span class="c1"># Design a network</span>
<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

    <span class="c1"># Convolution 1</span>
    <span class="n">conv1</span> <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">conv2d</span>     <span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;conv1&#39;</span>  <span class="p">)</span>
    <span class="c1"># Pooling 1</span>
    <span class="n">pool1</span> <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">max_pool2d</span> <span class="p">(</span><span class="n">conv1</span><span class="p">,</span>            <span class="mi">2</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;pool1&#39;</span>  <span class="p">)</span>
    <span class="c1"># Convolution 2</span>
    <span class="n">conv2</span> <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">conv2d</span>     <span class="p">(</span><span class="n">pool1</span><span class="p">,</span>        <span class="mi">64</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;conv2&#39;</span>  <span class="p">)</span>
    <span class="c1"># Pooling 2</span>
    <span class="n">pool2</span> <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">max_pool2d</span> <span class="p">(</span><span class="n">conv2</span><span class="p">,</span>            <span class="mi">2</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;pool2&#39;</span>  <span class="p">)</span>
    <span class="c1"># Flatten</span>
    <span class="n">flat</span>  <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">flatten</span>    <span class="p">(</span><span class="n">pool2</span><span class="p">,</span>               <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;flatten&#39;</span><span class="p">)</span>
    <span class="c1"># FC1</span>
    <span class="n">fc1</span>   <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">fully_connected</span> <span class="p">(</span><span class="n">flat</span><span class="p">,</span>  <span class="mi">1024</span><span class="p">,</span>    <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;fc1&#39;</span>    <span class="p">)</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s1">&#39;drop_out&#39;</span><span class="p">):</span>
        <span class="n">drop</span> <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">dropout</span> <span class="p">(</span><span class="n">fc1</span><span class="p">,</span> <span class="n">keep_prob</span><span class="p">,</span>      <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;dropout&#39;</span><span class="p">)</span>
    <span class="c1"># FC2</span>
    <span class="n">fc2</span>   <span class="o">=</span> <span class="n">slim</span><span class="o">.</span><span class="n">fully_connected</span> <span class="p">(</span><span class="n">drop</span><span class="p">,</span>    <span class="mi">10</span><span class="p">,</span>    <span class="n">scope</span><span class="o">=</span><span class="s1">&#39;fc2&#39;</span><span class="p">,</span> <span class="n">activation_fn</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    
    <span class="c1"># Dimension check if debug is True</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Input shape:&#39;</span><span class="p">,</span> <span class="n">input_tensor</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After conv1:&#39;</span><span class="p">,</span> <span class="n">conv1</span><span class="o">.</span><span class="n">shape</span>        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After pool1:&#39;</span><span class="p">,</span> <span class="n">pool1</span><span class="o">.</span><span class="n">shape</span>        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After conv2:&#39;</span><span class="p">,</span> <span class="n">conv2</span><span class="o">.</span><span class="n">shape</span>        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After pool2:&#39;</span><span class="p">,</span> <span class="n">pool2</span><span class="o">.</span><span class="n">shape</span>        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After fc1  :&#39;</span><span class="p">,</span> <span class="n">fc1</span><span class="o">.</span><span class="n">shape</span>          <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;After fc2  :&#39;</span><span class="p">,</span> <span class="n">fc2</span><span class="o">.</span><span class="n">shape</span>          <span class="p">)</span>

    <span class="k">return</span> <span class="n">fc2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... and let's actually build it! Enable <code>debug</code> boolean to print out the dimensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="n">image2d</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;Input shape:&#39;, TensorShape([Dimension(None), Dimension(28), Dimension(28), Dimension(1)]))
(&#39;After conv1:&#39;, TensorShape([Dimension(None), Dimension(28), Dimension(28), Dimension(32)]))
(&#39;After pool1:&#39;, TensorShape([Dimension(None), Dimension(14), Dimension(14), Dimension(32)]))
(&#39;After conv2:&#39;, TensorShape([Dimension(None), Dimension(14), Dimension(14), Dimension(64)]))
(&#39;After pool2:&#39;, TensorShape([Dimension(None), Dimension(7), Dimension(7), Dimension(64)]))
(&#39;After fc1  :&#39;, TensorShape([Dimension(None), Dimension(1024)]))
(&#39;After fc2  :&#39;, TensorShape([Dimension(None), Dimension(10)]))
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Add-trainable-variables-to-tensorboard">Add trainable variables to tensorboard<a class="anchor-link" href="#Add-trainable-variables-to-tensorboard">&#182;</a></h2><p>You might wonder "wait, how are variables monitored in Tensorboard?" Great point: last time we explicitly added all variables we defined to <code>tf.summary</code> by hand. This time, variables are internally defined within <code>slim</code> functions. So we are not adding them by hand. Fortunately there's an easy way to add all trainable variables to tensorboard log.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">for</span> <span class="n">tensor</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">GraphKeys</span><span class="o">.</span><span class="n">TRAINABLE_VARIABLES</span><span class="p">):</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">tensor</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>INFO:tensorflow:Summary name conv1/weights:0 is illegal; using conv1/weights_0 instead.
INFO:tensorflow:Summary name conv1/biases:0 is illegal; using conv1/biases_0 instead.
INFO:tensorflow:Summary name conv2/weights:0 is illegal; using conv2/weights_0 instead.
INFO:tensorflow:Summary name conv2/biases:0 is illegal; using conv2/biases_0 instead.
INFO:tensorflow:Summary name fc1/weights:0 is illegal; using fc1/weights_0 instead.
INFO:tensorflow:Summary name fc1/biases:0 is illegal; using fc1/biases_0 instead.
INFO:tensorflow:Summary name fc2/weights:0 is illegal; using fc2/weights_0 instead.
INFO:tensorflow:Summary name fc2/biases:0 is illegal; using fc2/biases_0 instead.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-loss-and-optimizer">Define loss and optimizer<a class="anchor-link" href="#Define-loss-and-optimizer">&#182;</a></h2><p>Thirdly, define training step, loss, and accuracy. This part is also identical to the last MNIST training tutorial.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Train operations</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">):</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">logits</span><span class="o">=</span><span class="n">net</span><span class="p">))</span>
    <span class="n">train_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
    
    <span class="n">correct_prediction</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">correct_prediction</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
    
    <span class="c1"># Monitor these loss and accuracy during training</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span><span class="n">loss</span><span class="p">)</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-session-and-tensorboard-log">Create a session and tensorboard log<a class="anchor-link" href="#Create-a-session-and-tensorboard-log">&#182;</a></h2><p>Final step before training. Define a session and tensorboard log writer. Again, identical to the last tutorial.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Define a session</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">InteractiveSession</span><span class="p">()</span>

<span class="c1"># Create log monitor</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;tb_log&#39;</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;tb_log&#39;</span><span class="p">)</span>
<span class="n">log_writer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">FileWriter</span><span class="p">(</span><span class="s1">&#39;tb_log&#39;</span><span class="p">)</span>
<span class="n">log_writer</span><span class="o">.</span><span class="n">add_graph</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
<span class="n">summary_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">merge_all</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train">Train<a class="anchor-link" href="#Train">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Let&#39;s time this</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Ready! initialize and train for 5000 steps</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>

    <span class="c1"># Fetch data of 50 images</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

    <span class="c1"># Every 100 steps, compute &amp; print the accuracy of the network&#39;s prediction</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">train_accuracy</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">images</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;step </span><span class="si">%d</span><span class="s1">, training accuracy </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">train_accuracy</span><span class="p">))</span>
    
    <span class="c1"># Every 20 steps, compute &amp; record tensorboard log</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">summary_op</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">images</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
        <span class="n">log_writer</span><span class="o">.</span><span class="n">add_summary</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Every step run training!</span>
    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_step</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">images</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="c1"># Compute &amp; print out the final accuracy</span>
<span class="n">batch</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;test accuracy </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">images</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">:</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}))</span>
<span class="k">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>step 0, training accuracy 0.08
step 100, training accuracy 0.82
step 200, training accuracy 0.9
step 300, training accuracy 0.88
step 400, training accuracy 0.94
step 500, training accuracy 0.94
step 600, training accuracy 0.98
step 700, training accuracy 0.96
step 800, training accuracy 0.96
step 900, training accuracy 0.98
step 1000, training accuracy 0.98
step 1100, training accuracy 0.96
step 1200, training accuracy 0.96
step 1300, training accuracy 1
step 1400, training accuracy 0.96
step 1500, training accuracy 0.98
step 1600, training accuracy 0.96
step 1700, training accuracy 0.94
step 1800, training accuracy 1
step 1900, training accuracy 0.94
test accuracy 0.9817
24.5175278187
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Both the performance and the training time should be roughly the same.</p>
<h2 id="Analysis">Analysis<a class="anchor-link" href="#Analysis">&#182;</a></h2><p>Finally, let's dump 10 images and check network's performance visually.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Define operations: a softmax probability, and the prediction by the network</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">):</span>
    <span class="n">softmax</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>
    <span class="n">prediction_label</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">net</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Dump some output images</span>
<span class="n">prob_array</span><span class="p">,</span> <span class="n">pred_label</span><span class="p">,</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">softmax</span><span class="p">,</span><span class="n">prediction_label</span><span class="p">],</span><span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">images</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">images</span><span class="p">,</span><span class="n">keep_prob</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span> <span class="s1">&#39;Prediction</span><span class="se">\033</span><span class="s1">[91m&#39;</span><span class="p">,</span><span class="n">pred_label</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[00mwith softmax prob</span><span class="se">\033</span><span class="s1">[94m&#39;</span><span class="p">,</span><span class="n">prob_array</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">pred_label</span><span class="p">[</span><span class="n">index</span><span class="p">]],</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[00m&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 7 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.999941 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABfRJREFUeJzt3c+LzXscx/HzvVgoG0QpoaxsyI+FQiElLPEfaDbsxNre
ys4/YGEhG4mFBYsZG1PkV2lWJKXGAiXU1+KuZnHe3zv3+M45M6/HY/vqzHzv4tlHfe53TtO27QDI
8s+4HwBYesKHQMKHQMKHQMKHQMKHQMKHQKv7/gVN0/gfBWAM2rZthm1OfAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAi0etwPMOnOnTtX7hcuXCj3jx8/lvuPHz/K
/datW+X+6dOncp+bmyt3MjnxIZDwIZDwIZDwIZDwIZDwIZDwIVDTtm2/v6Bp+v0FPeu6B9+xY8fS
PMgQX79+LfdXr14t0ZNMnvfv35f79evXy/3Zs2d/83GWXNu2zbDNiQ+BhA+BhA+BhA+BhA+BhA+B
hA+BvI/fYWpqqtx3795d7m/evCn3Xbt2lfu+ffvK/ejRo+V+8ODBcv/w4UO5b926tdxH8fv373L/
/PlzuW/ZsqXcu/7bu+75l/s9fsWJD4GED4GED4GED4GED4GED4GED4G8j7/Mbdiwodz37NlT7rOz
s+V+4MCBRT/Tf9X1nQLv3r0r99evX5f7+vXry/3ixYvlfvPmzXKfdN7HBxYQPgQSPgQSPgQSPgQS
PgQSPgRyj8/EOnv2bLnfvn273F++fFnux48fL/f5+flyn3Tu8YEFhA+BhA+BhA+BhA+BhA+BhA+B
3OMzNps3by73Fy9ejPT58+fPl/udO3fKfblzjw8sIHwIJHwIJHwIJHwIJHwIJHwItHrcD0Curr9r
v2nTpnL/8uVLub99+3bRz5TCiQ+BhA+BhA+BhA+BhA+BhA+BhA+BvI9Pbw4dOlTujx49Kvc1a9aU
+7Fjx8r9yZMn5b7SeR8fWED4EEj4EEj4EEj4EEj4EEj4EMj7+PTm9OnT5d51T991zz8zM7PoZ+Jf
TnwIJHwIJHwIJHwIJHwIJHwIJHwI5B6fkaxdu3bodvLkyfKzP3/+LPdr166V+69fv8qd4Zz4EEj4
EEj4EEj4EEj4EEj4EEj4EMg9PiO5cuXK0G3v3r3lZx88eFDu09PT/+uZ6ObEh0DCh0DCh0DCh0DC
h0DCh0DCh0BN2/b79fVN0/T7C+jVmTNnyv3u3btDt+/fv5efPXXqVLk/ffq03Km1bdsM25z4EEj4
EEj4EEj4EEj4EEj4EEj4EMj7+OE2btxY7jdu3Cj3VatWDd3u379fftY9/fg48SGQ8CGQ8CGQ8CGQ
8CGQ8CGQ8CGQ9/FXuOqefTAYDGZmZsp9//795T43Nzd063rfvvoso/M+PrCA8CGQ8CGQ8CGQ8CGQ
8CGQ8CGQ9/FXuJ07d5Z71z19l8uXLw/d3NNPLic+BBI+BBI+BBI+BBI+BBI+BBI+BHKPv8xt3769
3B8+fDjSz7969Wq537t3b6Sfz3g48SGQ8CGQ8CGQ8CGQ8CGQ8CGQ8CGQe/xlbmpqqty3bds20s9/
/Phxuff9vQz0w4kPgYQPgYQPgYQPgYQPgYQPgYQPgdzjT7jDhw+X+6VLl8q9aYZ+RfpgMOi+h3dP
vzI58SGQ8CGQ8CGQ8CGQ8CGQ8CGQ8CGQe/wJd+TIkXJft25duXfdw3d9h/23b9/KneXJiQ+BhA+B
hA+BhA+BhA+BhA+BhA+B3OOvcM+fPy/3EydOlPv8/PzffBwmhBMfAgkfAgkfAgkfAgkfAgkfAgkf
AjV9/930pmn8YXYYg7Zth36pghMfAgkfAgkfAgkfAgkfAgkfAi3Fa7mzS/A7gEXo/R4fmDz+qQ+B
hA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+BhA+B
/gCQtfi0/ptEVgAAAABJRU5ErkJggg==
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 2 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.999823 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABn5JREFUeJzt3T1rVfkaxuGsg4nYCJJCUtiICiJYSKysFQs1CEIQP4WG
gBaClfgR7ARJoRJfIGBhpVj4ggwiCikUFIugBEEMCKLuKU5zArOfdcyanUTv62pvsvaemfxYA//s
tZterzcEZPnPWr8BYPUJHwIJHwIJHwIJHwIJHwIJHwJtGPQLNE3jDwVgDfR6vabf5o4PgYQPgYQP
gYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQP
gQb+eG26mZqaKvdNmzaV+969e8v9xIkT5d72NeqXL1/uuz169Kj82ZmZmXJncNzxIZDwIZDwIZDw
IZDwIZDwIZDwIVDTdk7b+QV8TXbp2rVr5d52zt5V0/T9JuX/S/X78/r16/JnDx48WO7v379f0Xvi
v3xNNrCM8CGQ8CGQ8CGQ8CGQ8CGQ8CGQz+MPWNdz+rZz9ra/w5ifny/3e/fulfv27dvL/ejRo323
HTt2lD976tSpcr906VK5s3Lu+BBI+BBI+BBI+BBI+BBI+BBI+BDIOX5H4+Pj5X78+PFO13/58mW5
T0xMlPvi4mK5Ly0tlfvGjRvLvXp2ftsz/UdHR8udwXHHh0DCh0DCh0DCh0DCh0DCh0DCh0DO8Tsa
Gxsr97bP07969arcDx8+XO4LCwvl3tWZM2fKfffu3Su+9t27d1f8s3Tjjg+BhA+BhA+BhA+BhA+B
hA+BhA+BnON3NDc3V+47d+4s9y9fvpT7p0+ffvk9/ZsmJyfLfXh4eMXXbvtOAAbHHR8CCR8CCR8C
CR8CCR8CCR8CCR8COccfsHfv3q31WyhNT0+X+65du1Z87SdPnpT706dPV3xtunHHh0DCh0DCh0DC
h0DCh0DCh0DCh0DNoD8T3TSND12voSNHjpT7jRs3yn1kZKTcP3782Hc7efJk+bMPHjwod7rp9Xp9
v9TBHR8CCR8CCR8CCR8CCR8CCR8CCR8C+Tz+H258fLzc287p21y/fr3v5px+/XLHh0DCh0DCh0DC
h0DCh0DCh0DCh0DO8X9zt2/fLvdDhw51uv7Vq1fL/fz5852uz9pwx4dAwodAwodAwodAwodAwodA
wodAnqu/zo2NjZX78+fPy310dLTcFxcXy/3AgQPl/ubNm3Jn7XiuPrCM8CGQ8CGQ8CGQ8CGQ8CGQ
8CGQz+Ovc7Ozs+Xedk7fZmZmptyd0/+Z3PEhkPAhkPAhkPAhkPAhkPAhkPAhkHP8NXbs2LFy37dv
X6fr379/v9wvXLjQ6fr8ntzxIZDwIZDwIZDwIZDwIZDwIZDwIZBz/AFr+7z8uXPnyn14eLjT67c9
d39paanT9fk9ueNDIOFDIOFDIOFDIOFDIOFDIOFDIOf4AzY1NVXu+/fv73T9O3fulLvP2/NP3PEh
kPAhkPAhkPAhkPAhkPAhkPAhUNPr9Qb7Ak0z2BdY575+/VruIyMj5d7232fbtm3lvrCwUO78uXq9
XtNvc8eHQMKHQMKHQMKHQMKHQMKHQMKHQD6PP2BN0/co9V+xZcuWcv/27dtAX7/y+fPncv/+/Xu5
t32nwObNm3/5Pf2vtn93p0+f7nT9Nm3//GfPni33tr8RqbjjQyDhQyDhQyDhQyDhQyDhQyDhQyDn
+Otc298BvHjxYpXeyT+rnhcwOztb/mzbswK2bt1a7pOTk+X+u/vw4UO5X7x4ccXXdseHQMKHQMKH
QMKHQMKHQMKHQMKHQJ6rP2C3bt0q94mJiVV6J6tv0L9bbX78+FHuP3/+LPe29z83N1fuz549K/c2
Dx8+LPfHjx+Xu+fqA8sIHwIJHwIJHwIJHwIJHwIJHwI5xx+wts/TT09Pl3vbs+W72rNnT7l3+cx7
2+/WlStXyv3t27crfu2hoaGhmzdvlvv8/Hyn6693zvGBZYQPgYQPgYQPgYQPgYQPgYQPgZzjwx/K
OT6wjPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAh
kPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAh
0IZVeI2/VuE1gF/Q9Hq9tX4PwCrzv/oQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQ
SPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQ6G+58xm5t/ezGQAAAABJRU5ErkJggg==
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 1 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.998104 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABRFJREFUeJzt3SGLlFscwOH7XrVoE5RtmkREUcFgWLBYxGS22C1+D6vf
wCYKhgWNgslytxlMBpMGk2KR94ZbNMxZvTOzO+7veeqfM+8pP87C2Xlnmuf5L6Dl74PeALD/hA9B
wocg4UOQ8CFI+BAkfAg6uu4HTNPkHwXgAMzzPC2aOfEhSPgQJHwIEj4ECR+ChA9Bwocg4UOQ8CFI
+BAkfAgSPgQJH4KED0HChyDhQ5DwIUj4ECR8CBI+BAkfgoQPQcKHIOFDkPAhSPgQJHwIEj4ECR+C
hA9Ba/+ZbLrOnTs3nL99+3Y4f/DgwXD+6NGj394T/3HiQ5DwIUj4ECR8CBI+BAkfgoQPQe7xWZur
V68O5/M8D+cfPnxY5Xb4gRMfgoQPQcKHIOFDkPAhSPgQJHwIco/P2ly5cmU4//Lly3D+/PnzVW6H
HzjxIUj4ECR8CBI+BAkfgoQPQcKHIPf4LOXixYsLZ/fv3x+uffz48aq3wy9y4kOQ8CFI+BAkfAgS
PgQJH4KED0Hu8VnK+fPnF85OnDgxXPvkyZNVb4df5MSHIOFDkPAhSPgQJHwIEj4ECR+Cpr1+o3zp
B0zTeh/AgXrz5s3C2alTp4ZrL126NJzv9d59xuZ5nhbNnPgQJHwIEj4ECR+ChA9Bwocg4UOQ7+Mz
dPbs2eH82rVrC2fv3r0brnVPf3Cc+BAkfAgSPgQJH4KED0HChyDhQ5B7fIZu3Ljxv9d++vRphTth
lZz4ECR8CBI+BAkfgoQPQcKHIOFDkHt8hvZ69/3Iw4cPV7gTVsmJD0HChyDhQ5DwIUj4ECR8CBI+
BE3zvN6fr5+mab0PYCnXr18fznd2dobz9+/fL5xtb28P13779m04ZznzPE+LZk58CBI+BAkfgoQP
QcKHIOFDkPAhyPfx427evDmcnzx5cjh/+fLlwpl7+s3lxIcg4UOQ8CFI+BAkfAgSPgQJH4Lc48dd
vnx5ON/rfQ3Pnj1b5XbYJ058CBI+BAkfgoQPQcKHIOFDkPAhyHv1D7mtra3hfHd3dzj//PnzcH7h
woXf3hP7w3v1gZ8IH4KED0HChyDhQ5DwIUj4EOT7+IfcvXv3hvPTp08P5y9evFjhbtgUTnwIEj4E
CR+ChA9Bwocg4UOQ8CHIPf4hd+bMmaXW7/V9fP5MTnwIEj4ECR+ChA9Bwocg4UOQ8CHIPf4hd/v2
7aXW7+zsrGgnbBInPgQJH4KED0HChyDhQ5DwIUj4EOQe/w+3vb09nG9tbS31+fM8L7WezeTEhyDh
Q5DwIUj4ECR8CBI+BAkfgtzj/+Hu3LkznB85cmQ4393dHc5fv37923ti8znxIUj4ECR8CBI+BAkf
goQPQcKHIPf4G+748ePD+a1bt5b6/KdPnw7n379/X+rz2UxOfAgSPgQJH4KED0HChyDhQ5DwIWha
93vTp2nyYvYlHDt2bDh/9erVcP7x48fh/O7du8P5169fh3M21zzP06KZEx+ChA9Bwocg4UOQ8CFI
+BAkfAhyjw+HlHt84CfChyDhQ5DwIUj4ECR8CBI+BAkfgoQPQcKHIOFDkPAhSPgQJHwIEj4ECR+C
hA9Bwocg4UOQ8CFI+BAkfAgSPgQJH4KED0HChyDhQ5DwIUj4ECR8CDq6D8/4Zx+eAfyGaZ79fD3U
+FMfgoQPQcKHIOFDkPAhSPgQJHwIEj4ECR+ChA9Bwocg4UOQ8CFI+BAkfAgSPgQJH4KED0HChyDh
Q9C/99GWzptMWZgAAAAASUVORK5CYII=
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 0 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.999941 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABr9JREFUeJzt3b1rVHkfxuFMWCtb01hIikDQykLEKoKVgSipRG0URA2I
sVYLIWXAzpcEG/8BC8U0NhZKugg2YycmFiKKIEgE0cxTPM2myPfgHse83NfV3pyZ2cQPZ+GXmen0
er0BIMvgZr8A4O8TPgQSPgQSPgQSPgQSPgQSPgT6p99P0Ol0/KEAbIJer9fZaHPHh0DCh0DCh0DC
h0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DCh0DC
h0DCh0DCh0DCh0DCh0DCh0DCh0DCh0B9/5psNtfu3bvLfXZ2ttwvXbpU7ktLSxtup06dKq9dWVkp
d/rHHR8CCR8CCR8CCR8CCR8CCR8CCR8CdXq9Xn+foNPp7xNQGhkZKfdut1vunU7nP+/T09Pltffu
3St32un1ehv+ctzxIZDwIZDwIZDwIZDwIZDwIZDwIZD3429zQ0ND5f7w4cNybzqnZ2dyx4dAwodA
wodAwodAwodAwodAwodAzvG3uKtXr5b75ORkuR8+fPhPvpzfMjY2Vu6Dg/V95/Xr1+X+4sWL335N
/J87PgQSPgQSPgQSPgQSPgQSPgQSPgTyufpb3M+fP8t9bW2t3Pv9fvvq8ZteW5N3796V++nTp8v9
1atXrZ5/u/O5+sA6wodAwodAwodAwodAwodAwodAzvE32cLCQrmPj4+Xe9uz8ra+fPmy4fbt27fy
2n379rV67qZ/u7t27Wr1+Nudc3xgHeFDIOFDIOFDIOFDIOFDIOFDIJ+r32dHjx4t99HR0XJvOqtu
+3cYTdfPz8+X+7Nnzzbcvn79Wl577Nixcr9582a5N732qampcp+bmyv3ncwdHwIJHwIJHwIJHwIJ
HwIJHwIJHwJ5P35Lw8PD5b64uFjue/bsKfem75Bvej/+8vJyuT969KjcZ2Zmyn11dbXcK/3+2X3/
/r3cb926Ve537twp96bvPNhs3o8PrCN8CCR8CCR8CCR8CCR8CCR8COQcv6WRkZFy73a75d70/fVN
+/Pnz8v9zJkz5f758+dy30zT09Plfvv27XJv+tn9+vWr3Pfv31/ub9++LffN5hwfWEf4EEj4EEj4
EEj4EEj4EEj4EMjn6vdZ01ly099RLC0tlfuFCxfKfSuf0zd5/PhxuZ89e7bcDx06VO5Nv5udzB0f
AgkfAgkfAgkfAgkfAgkfAgkfAjnH77O277c/cuTIn3w520rTz6bpOwea9iZNn7t/7ty5Vo+/mdzx
IZDwIZDwIZDwIZDwIZDwIZDwIZBz/JampqbKven99v3+XoPt7MSJE+V+8ODBcm/62a6trZX7zMxM
uW9n7vgQSPgQSPgQSPgQSPgQSPgQSPgQyDl+SxMTE5v9ErasoaGhcj9w4EC5X79+vdzbfmfBp0+f
yv3Hjx/lvp2540Mg4UMg4UMg4UMg4UMg4UMg4UMg5/gtJX/HepMbN26U+5UrV1o9ftM5/fLycrmf
P3++3N+/f/+7L2nbcMeHQMKHQMKHQMKHQMKHQMKHQMKHQM7xaWVhYWHDbXR0tLy27d9ANJ3jd7vd
cn/58mWr59/O3PEhkPAhkPAhkPAhkPAhkPAhkPAhkHP8lprOotvux48fb3X9/Px8ue/du7fcmwwO
bnzvaPr++baa/ttPnjzZ1+ffztzxIZDwIZDwIZDwIZDwIZDwIZDwIZBz/Jbu379f7rOzs60e/+nT
p+Xe9qy86T3tba7v52MPDAwMzM3NtXr8ZO74EEj4EEj4EEj4EEj4EEj4EEj4EKjT9qy18Qk6nf4+
wSYbHh4u98XFxXIfGhoq96b3nPf799eken0fP34sr33z5k25X758udw/fPhQ7qurq+W+0/V6vQ1/
Oe74EEj4EEj4EEj4EEj4EEj4EEj4EMg5fp+NjY2V++TkZLlPT0+X+1Y+x7927Vp57d27d//0y+Ff
nOMD6wgfAgkfAgkfAgkfAgkfAgkfAjnH3+LGx8fL/eLFi+U+MTFR7k+ePCn3Bw8elHt1jt/tdstr
V1ZWyp12nOMD6wgfAgkfAgkfAgkfAgkfAgkfAjnHhx3KOT6wjvAhkPAhkPAhkPAhkPAhkPAhkPAh
kPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAh
kPAhkPAhkPAh0D9/4Tle/YXnAH5Dp9fz9fWQxv/qQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDh
QyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQ6D/AZ3BUE6Q7Qa7AAAAAElFTkSuQmCC
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 4 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.999651 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABi5JREFUeJzt3TFsjXscxnGvEA0JqYhELE1ZGo2IGEgkYhDRxIJJFxa7
lUnCYulotVk62o/BRhoS0gWTsYIQHUTfu7rJ7e+k95y3p6fP57M+ad83V7/53+RPT9O27Q4gy85R
vwCw+YQPgYQPgYQPgYQPgYQPgYQPgXZ1/YCmafxFARiBtm2b9TYnPgQSPgQSPgQSPgQSPgQSPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgTaNeoXoHb69OlyX1xcLPfp6elh
vs6WcunSpXJfXl4u98+fPw/zdcaKEx8CCR8CCR8CCR8CCR8CCR8CCR8Cucff4i5fvlzuExMTm/Qm
W8/Vq1fL/fbt2+V+8+bNYb7OWHHiQyDhQyDhQyDhQyDhQyDhQyDhQyD3+CO2a1f9R3DlypVNepPx
s7S0VO53794t971795b7r1+/NvxO48KJD4GED4GED4GED4GED4GED4GED4Hc44/YxYsXy/3cuXPl
/vjx42G+zliZnJws95mZmXJ3jw9EET4EEj4EEj4EEj4EEj4EEj4Eatq27fYBTdPtA7a42dnZcu/1
euX+5cuXcj9z5ky5//z5s9zHWb//dufPny/3I0eOlPvKysqG32kradu2WW9z4kMg4UMg4UMg4UMg
4UMg4UMg4UMg/x6/Y/fv3y/3ffv2lXu/36u/ne/pDx48WO4XLlwo97W1tWG+zrbixIdAwodAwodA
wodAwodAwodAwodA7vEHdOPGjXKfm5sr9w8fPpT769evN/xO28W9e/fKvd89/YsXL8r9+/fvG32l
bcOJD4GED4GED4GED4GED4GED4GED4Hc4w+o3z1+v89gf/LkyTBfZ6xMTU2V+/z8fLn/+fOn3B89
elTuv3//LvftzIkPgYQPgYQPgYQPgYQPgYQPgYQPgdzj93HgwIFyP3v27EDfP/ke/86dO+V+6NCh
cl9eXi73Xq+34XdK4cSHQMKHQMKHQMKHQMKHQMKHQMKHQO7x+9izZ0+5Hz16tNyfPXs2zNfZVo4d
OzbQ1797925Ib5LHiQ+BhA+BhA+BhA+BhA+BhA+BhA+B3OP38ePHj3J/+/ZtuZ88ebLcJycny/3r
16/lvpUdPny43K9fvz7Q93/58uVAX5/MiQ+BhA+BhA+BhA+BhA+BhA+BhA+B3OP3sbq6Wu4fP34s
92vXrpX78+fPy31hYaHcuzY7O1vu09PT625TU1MDPbtt23JfW1sb6Psnc+JDIOFDIOFDIOFDIOFD
IOFDIOFDoKbfXenAD2iabh8wYjMzM+X+4MGDcp+bmyv3fr/Xv2srKyvlXv389Pt8+50763On38/m
/v37y73f38HY7tq2bdbbnPgQSPgQSPgQSPgQSPgQSPgQSPgQyD3+iJ06darcjx8/vklv8t8WFxfL
vWnWvSre8fTp0/Jr5+fny73fz+bu3bvLPZ17fOBfhA+BhA+BhA+BhA+BhA+BhA+B/F79EXvz5s1A
+6hVd+2fPn3q9NknTpwo9/fv33f6/HHmxIdAwodAwodAwodAwodAwodAwodA7vHpTPVv9Yfx9e7p
/z8nPgQSPgQSPgQSPgQSPgQSPgQSPgRyj09nBv3Mhq4/8yGZEx8CCR8CCR8CCR8CCR8CCR8CCR8C
ucenMxMTE+Xe755+dXV1mK/DX5z4EEj4EEj4EEj4EEj4EEj4EEj4EMg9Pp25detWuX/79q3cHz58
OMS34W9OfAgkfAgkfAgkfAgkfAgkfAgkfAjkHp/OvHr1qtwXFhbKvdfrDfN1+IsTHwIJHwIJHwIJ
HwIJHwIJHwIJHwI1XX8GedM0PuQcRqBt22a9zYkPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQP
gYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgYQPgTbjY7KXNuEZwAZ0/nv1ga3H/+pD
IOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFDIOFD
oH8AWb/kHGeekgcAAAAASUVORK5CYII=
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 1 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.999284 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABUxJREFUeJzt3S9vFVkcgOF7yQICWVsUkgRVTANYFAoMH4IvQPopMDRo
BLIaLIqQxSARhCBJoK7866zezd5zQyelpe/z2F/mzJiXQ3LuTJfTNC2AlnMn/QDA7yd8CBI+BAkf
goQPQcKHIOFD0F/HfYPlcumHAnACpmlarprZ8SFI+BAkfAgSPgQJH4KED0HChyDhQ5DwIUj4ECR8
CBI+BAkfgoQPQcKHIOFDkPAhSPgQJHwIEj4ECR+ChA9Bwocg4UOQ8CFI+BAkfAgSPgQJH4KED0HC
hyDhQ5DwIUj4ECR8CBI+BAkfgoQPQX+d9ANwdt25c2c439vbG84fPHgwnO/u7g7nh4eHw3mZHR+C
hA9Bwocg4UOQ8CFI+BAkfAhaTtN0vDdYLo/3BpyojY2NlbM3b94Mr718+fJwvu4c/tKlS8P5wcHB
cH7WTdO0XDWz40OQ8CFI+BAkfAgSPgQJH4KED0Hex2eWW7durZxtbm4Or133G5Jnz54N51+/fh3O
Wc2OD0HChyDhQ5DwIUj4ECR8CBI+BDnHZ+jixYvD+cOHD1fOlsuVr4MvFov15/hPnz6ddT2r2fEh
SPgQJHwIEj4ECR+ChA9Bwocg39VnaGtrazh/9erVkdf+8ePHcH7hwoUjr43v6gP/IXwIEj4ECR+C
hA9Bwocg4UOQ9/EZunv37nA+eud+3W9Enj9/fqRnYj47PgQJH4KED0HChyDhQ5DwIUj4EOQcn6Gb
N28O56Oz+m/fvg2v3dnZOdIzMZ8dH4KED0HChyDhQ5DwIUj4ECR8CPJd/bjt7e3h/OXLl0de+/Pn
z8P5xsbGkddmPd/VB/5F+BAkfAgSPgQJH4KED0HChyDv48ddv359OB99N3+xGL+P//jx4yM9E8fP
jg9Bwocg4UOQ8CFI+BAkfAgSPgQ5x4/b2toaztd9r+HLly8rZ7u7u0d6Jo6fHR+ChA9Bwocg4UOQ
8CFI+BAkfAhyjn/G3bhxYzi/f//+rPX39/dXzj5+/DhrbY6PHR+ChA9Bwocg4UOQ8CFI+BAkfAhy
jn/Grfsb9OfOzfu3/8WLF7Ou52TY8SFI+BAkfAgSPgQJH4KED0HChyDn+GfcvXv3Zl0/+m7+YrFY
PHnyZNb6nAw7PgQJH4KED0HChyDhQ5DwIUj4ELRc9/fPZ99guTzeG8Rtbm4O5+/fvx/O172P//bt
2+H82rVrwzknZ5qm5aqZHR+ChA9Bwocg4UOQ8CFI+BAkfAjyPv4fbnt7ezif+938vb29WddzOtnx
IUj4ECR8CBI+BAkfgoQPQcKHIOf4f7iNjY1Z13/69Gk4f/To0az1OZ3s+BAkfAgSPgQJH4KED0HC
hyDhQ5Bz/D/c7du3Z13/4cOH4Xx/f3/W+pxOdnwIEj4ECR+ChA9Bwocg4UOQ8CHIOf4pd/78+eH8
ypUrs9Y/ODgYzr9//z5rfU4nOz4ECR+ChA9Bwocg4UOQ8CFI+BDkHP+UOzw8HM5fv349nF+9enU4
f/fu3S8/E38+Oz4ECR+ChA9Bwocg4UOQ8CFI+BDkHP+U+/nz53C+s7MznE/TNJyv+x0AZ5MdH4KE
D0HChyDhQ5DwIUj4ECR8CFquO+edfYPl8nhvAPyvaZqWq2Z2fAgSPgQJH4KED0HChyDhQ5DwIUj4
ECR8CBI+BAkfgoQPQcKHIOFDkPAhSPgQJHwIEj4ECR+ChA9Bwocg4UPQ7/gz2X//hnsAv+DYv6sP
nD7+qw9Bwocg4UOQ8CFI+BAkfAgSPgQJH4KED0HChyDhQ5DwIUj4ECR8CBI+BAkfgoQPQcKHIOFD
kPAh6B8jwreYC6Vo2QAAAABJRU5ErkJggg==
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 4 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.996554 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABolJREFUeJzt3T+ozX8cx/H7/WVR5E9yY2OVGO5gubkTbkaZSN0oN4MM
BpJBGc3IIIkiyoLIZrjTxU1301VSt7jqDne7cc9vNpz34X5/x70/r8djfXXO95vbs6/6nHNv0+l0
BoAs/6z0DQB/nvAhkPAhkPAhkPAhkPAhkPAh0Jp+X6BpGh8UgBXQ6XSabpsnPgQSPgQSPgQSPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgRas9I3kG7r1q3l/vDh
w3KfmJgo91u3bpX7p0+fyv1vtmHDhnIfHh4u9xcvXpT79+/ff/ue/hRPfAgkfAgkfAgkfAgkfAgk
fAgkfAjkHL/PNm3aVO7T09Pl3uus+cuXL+XunL67ycnJct+yZUu5Dw0NlfvMzEy5ryRPfAgkfAgk
fAgkfAgkfAgkfAgkfAjkHL+lXme9Dx48KPfNmzeX+/Xr18v97Nmz5Z7s0qVL5b5jx45yHx8fL/fV
fE7fiyc+BBI+BBI+BBI+BBI+BBI+BBI+BGo6nU5/L9A0/b3ACjtw4EC5P3/+vNX7b9u2rdzn5uZa
vf//2a5du8r9/fv35f7kyZNyHxsbK/eFhYVyX2mdTqfptnniQyDhQyDhQyDhQyDhQyDhQyDhQyDf
x++h19+vP3LkSKv3P3XqVLk7p+/u1atXrd6/1zn+aj+nb8MTHwIJHwIJHwIJHwIJHwIJHwIJHwI5
x+/h2rVr5X78+PFyf/PmTbk/evTot+8pxfDwcLkPDg6W+507d8r9/v37v3tLfw1PfAgkfAgkfAgk
fAgkfAgkfAgkfAjkHL+lpaWlcp+dnS33xcXF//J2VpW1a9eW+8WLF8v9zJkz5d7rb0KcPHmy3JN5
4kMg4UMg4UMg4UMg4UMg4UMg4UMg5/gtNU3XP0E+MDAwMHD48OFyf/nyZbnPz8+X+82bN8u93/bv
3991GxkZKV+7b9++Vtd+/Phxq9cn88SHQMKHQMKHQMKHQMKHQMKHQMKHQE2v7zS3vkDT9PcCfTY0
NFTuvf7G+vbt28u9179/r88J9Pvn10t1f23v7ePHj+U+Ojpa7jMzM62u/3/X6XS6/nA88SGQ8CGQ
8CGQ8CGQ8CGQ8CGQ8CGQ7+P3MDk5We579uwp971795b7wYMHy/38+fPlPjc3V+53794t97bu3bvX
dZuamipf2+ucf2JiotzTz+nb8MSHQMKHQMKHQMKHQMKHQMKHQMKHQL6PTys7d+7sun348KF8ba9z
/kOHDpV7r88wpPN9fOAnwodAwodAwodAwodAwodAwodAvo9PK5cvX+669fqMyIULF8rdOX3/eOJD
IOFDIOFDIOFDIOFDIOFDIOFDIOf4lI4ePVruJ06c6LotLCyUr/327duy7on2PPEhkPAhkPAhkPAh
kPAhkPAhkPAhkHN8SqOjo8t+7dOnT8v93bt3y35v2vHEh0DCh0DCh0DCh0DCh0DCh0DCh0BNr999
3voCTdPfC9BXs7Oz5b5u3bqu28jISPnat2/fLueW+EWdTqfptnniQyDhQyDhQyDhQyDhQyDhQyDh
QyDfxw83Pj5e7oODg+X+9evXrptz+tXLEx8CCR8CCR8CCR8CCR8CCR8CCR8COccPd/r06XLv9fsa
nj17tuxrr1+/vtw3btxY7p8/f172tdN54kMg4UMg4UMg4UMg4UMg4UMg4UMg5/jhmqbrr17/JT9+
/Oi6HTt2rHztuXPnyn16errcx8bGyp3uPPEhkPAhkPAhkPAhkPAhkPAhkPAhUNPr+9atL9A0/b0A
rUxNTZX77t27l/3eS0tL5X779u1yv3r1arn7Pn6t0+l0/ZCGJz4EEj4EEj4EEj4EEj4EEj4EEj4E
co4fbnh4uNyvXLlS7q9fv+663bhxo3zt/Px8uS8uLpY7Nef4wE+ED4GED4GED4GED4GED4GED4Gc
48Nfyjk+8BPhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDhQyDh
QyDhQyDhQyDhQyDhQ6A1f+Aab//ANYDf0Pffqw+sPv6rD4GED4GED4GED4GED4GED4GED4GED4GE
D4GED4GED4GED4GED4GED4GED4GED4GED4GED4GED4GED4H+BWbSJ2PY3lRyAAAAAElFTkSuQmCC
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 9 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.888057 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABpBJREFUeJzt3D+ozX8cx3FHIuJGt5SiW9cdhMGfxGhwU4pS/tybKGVS
d1OYJFIm6m4Wgz+RSNlkYzCRqDvcupPFwL0DuaHOb/oNZ7jvb1zXubwej/XVud9vuc++6nO/p9Vu
txcAWRZ2+waAP0/4EEj4EEj4EEj4EEj4EEj4EGjRXF+g1Wr5QwHogna73Zpp88SHQMKHQMKHQMKH
QMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKH
QMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKHQMKH
QMKHQMKHQMKHQMKHQIu6fQPMTk9PT7lfuXKl3Ddt2lTug4OD5f7jx49yZ37yxIdAwodAwodAwodA
wodAwodAwodAzvHnuWPHjpX75cuXy33dunXl3m63y73p7wQ+ffpU7sxPnvgQSPgQSPgQSPgQSPgQ
SPgQSPgQqNV0jjvrC7Rac3uBv9zatWvL/dWrV+Xe29s7q+s3/fvfu3ev3EdGRmbcJicnf+me+D3a
7XZrps0THwIJHwIJHwIJHwIJHwIJHwIJHwI5x++ya9eulXt1Tr5gwYIFrdaMR7W/RdPvx9TU1Ixb
03f6j46Olvv379/LnZpzfKCD8CGQ8CGQ8CGQ8CGQ8CGQ8CGQc/w51tfXV+5v3rwp9+XLl5f7u3fv
yv3Dhw/lvmfPnnJvUv3+NF1727Zt5d70eWrO8YEOwodAwodAwodAwodAwodAwodAi7p9A/+6LVu2
lPuKFSvK/fnz5+W+e/fucl+6dGm5Dw8Pl/v58+fLff369TNua9asKT/7+PHjct+3b1+5+97+X+eJ
D4GED4GED4GED4GED4GED4GED4Gc48+xJUuWlHvT9yFcv359Vtf/+vVrud+8ebPcDx06VO79/f0/
fU//a7q3b9++/fLPpuaJD4GED4GED4GED4GED4GED4GED4Gc48+xoaGhWX2+6Z30pnfamzT9HcH2
7dtn9fMrL1++LPcvX77M2bXTeeJDIOFDIOFDIOFDIOFDIOFDIOFDIOf4c+z+/fvlfuDAgXLfsWNH
uW/YsKHcN2/eXO4HDx4s91WrVpX71NTUjNvKlSvLz546darcb926Ve5jY2Plzsw88SGQ8CGQ8CGQ
8CGQ8CGQ8CGQ8CFQq+l97FlfoNWa2wvMc729veU+Pj5e7j09PeXearXKfbb/vs+ePSv3kZGRGbcn
T56Unx0YGCj3GzdulPvp06fLPV273Z7xl8MTHwIJHwIJHwIJHwIJHwIJHwIJHwJ5H3+Offz4sdyP
Hj1a7g8ePCj3pnP+JqOjo+V+7ty5cp+enp5xe/ToUfnZs2fPlvvevXvLvb+/v9wnJibKPZknPgQS
PgQSPgQSPgQSPgQSPgQSPgTyPv48Nzg4WO7Dw8PlPjk5We4XLlwo98+fP5d7ZdmyZeV+586dct+/
f3+5N33v/smTJ8v9X+d9fKCD8CGQ8CGQ8CGQ8CGQ8CGQ8CGQc3y6ZmhoqNxv375d7u/fvy/3rVu3
lnvT3zj87ZzjAx2ED4GED4GED4GED4GED4GED4Gc49M1CxfWz52mc/wjR46U+8WLF8v90qVL5f63
c44PdBA+BBI+BBI+BBI+BBI+BBI+BHKOz7zV9D79ixcvyn3x4sXlvnHjxnIfHx8v9/nOOT7QQfgQ
SPgQSPgQSPgQSPgQSPgQyDk+f60zZ86U+9WrV8v94cOH5X7ixIlyn56eLvduc44PdBA+BBI+BBI+
BBI+BBI+BBI+BHKOz19r9erV5d70vn5/f3+5N30fwNu3b8u925zjAx2ED4GED4GED4GED4GED4GE
D4Gc4/PP6uvrK/eJiYlyv3v3brkfP378p+/pT3KOD3QQPgQSPgQSPgQSPgQSPgQSPgRyjk+sp0+f
lvvOnTvLfdeuXeU+Njb20/f0OznHBzoIHwIJHwIJHwIJHwIJHwIJHwIt6vYNQLccPny43F+/fl3u
AwMD5d7tc/yKJz4EEj4EEj4EEj4EEj4EEj4EEj4E8j4+/KO8jw90ED4EEj4EEj4EEj4EEj4EEj4E
Ej4EEj4EEj4EEj4EEj4EEj4EEj4E+hNfr/3qD1wD+Alz/j4+MP/4rz4EEj4EEj4EEj4EEj4EEj4E
Ej4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4E+g81j0Owi1e0gwAAAABJ
RU5ErkJggg==
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 5 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.97577 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABs9JREFUeJzt3c+LzX0fx/E5DBpshLIwqBFlYcqPlIUmWylZWIgdGwsj
Kzs/SpK/QCSl+QMkC01TUkLqmghJFmMaC5MNNWmKOfd6ujvvc7uPY+57Xo/H9tV3zrkmT9+rPs73
NJrNZg+QZclCvwHg7xM+BBI+BBI+BBI+BBI+BBI+BOrt9gs0Gg3/UAAWQLPZbLTa3PEhkPAhkPAh
kPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAh
kPAhkPAhkPAhkPAhkPAhkPAhkPAhkPAhUNe/JhtaWbNmTbn39/d39fUnJyfL/dy5c+X+5s2bcv/w
4UO5v379uty7yR0fAgkfAgkfAgkfAgkfAgkfAgkfAjnHpyOHDh1quR0+fLi8dmhoqNy3bt3637yl
/1i7c/bNmzeX+4oVK8q92WyW+7Jly8q9m9zxIZDwIZDwIZDwIZDwIZDwIZDwIVCj3Vljxy/QaHT3
BSgNDAyU+5kzZ8r99OnT5d7X19dyazQa5bXtdHp9O53+2W/3/tr9/N7e7v4zmmaz2fINuuNDIOFD
IOFDIOFDIOFDIOFDIOFDIJ/HX+Q2btxY7sPDw1177YU+h3///n25v3v37k++nX/T7X8j0wl3fAgk
fAgkfAgkfAgkfAgkfAgkfAjkHL/L1q1bV+5nz54t96dPn5b7o0ePyn12drbcv3//Xu4zMzPlvnLl
ypbb6OhoeW2775d/8eJFuY+Pj5f7jx8/yr3df9ti5o4PgYQPgYQPgYQPgYQPgYQPgYQPgTxXv0Or
Vq0q9ydPnpT7zp07y/3o0aPl/uDBg3JvZ8uWLeX+6dOncu/v72+5TU1NldfOzc2VO53xXH1gHuFD
IOFDIOFDIOFDIOFDIOFDIJ/Hb2P58uXlPjIyUu6Dg4Plfu3atXIfGxsr905NTEx0dP3k5OSfeSP8
Ve74EEj4EEj4EEj4EEj4EEj4EEj4ECj+8/irV68u9wsXLnS0f/36tdy3b99e7t++fSt3aMXn8YF5
hA+BhA+BhA+BhA+BhA+BhA+B4j+Pf+TIkXJvd07f7vPoBw4cKHfn9CwEd3wIJHwIJHwIJHwIJHwI
JHwIJHwIFH+Ov3///o6uHx8fL/d23xEPC8EdHwIJHwIJHwIJHwIJHwIJHwIJHwLFP1f/y5cv5b52
7dpyn52dLffr16+X+/3798v91atX5Q6teK4+MI/wIZDwIZDwIZDwIZDwIZDwIVD8Of7c3Fy5t/v9
dPr7+/XrV7nfvHmz3J8/f17umzZtKvePHz+W+9u3b8u90Wh5VNyzY8eO8tpnz56V++fPn8udmnN8
YB7hQyDhQyDhQyDhQyDhQyDhQ6D4c/wbN26U+/nz57v6+t3+/f8vm56eLvfHjx+X+/Hjx//gu1l8
nOMD8wgfAgkfAgkfAgkfAgkfAgkfAsWf4y9durTcd+3aVe4jIyPl3tvbW+79/f3lvmTJ4v27udNn
HVy6dKncr169+rtvaVFxjg/MI3wIJHwIJHwIJHwIJHwIJHwIVB8yB2j3XPuXL1+W+7Zt28q9eu58
T09Pz8GDB8t9+fLl5X7x4sVy37t3b7kvpHa/m3Z27979h95JHnd8CCR8CCR8CCR8CCR8CCR8CCR8
CBR/jt9t7T5TPjY21tHPHxwcLPc9e/aU+8+fP8v97t275X779u2W2/DwcHmt5+IvHHd8CCR8CCR8
CCR8CCR8CCR8CCR8COQc///c6Ohoubd7tny75/6fOnWq3AcGBlpuQ0ND5bWdmpqa6urPX8zc8SGQ
8CGQ8CGQ8CGQ8CGQ8CGQ8CFQo93nxTt+gUajuy8Qrq+vr9zv3LlT7seOHevo9Tv589PuOw0ePnxY
7idPniz3mZmZ335Pi0mz2Wz5xQXu+BBI+BBI+BBI+BBI+BBI+BBI+BDIOf4it2HDhnK/detWubd7
Lv/69etbbhMTE+W19+7dK/fLly+XOzXn+MA8wodAwodAwodAwodAwodAwodAzvHDNRotj3p7enp6
ek6cOFHu+/bta7lduXKlvHZ6errc6YxzfGAe4UMg4UMg4UMg4UMg4UMg4UMg5/iwSDnHB+YRPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQS
PgQSPgQSPgQSPgQSPgQSPgQSPgQSPgQSPgTq/Quv8c9feA3gNzSaTV9fD2n8rz4EEj4EEj4EEj4E
Ej4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4EEj4E+hfuCFLVKheU
ZgAAAABJRU5ErkJggg==
">
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction<span class="ansi-red-intense-fg"> 9 </span>with softmax prob<span class="ansi-blue-intense-fg"> 0.987713 </span>
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAD8CAYAAABXXhlaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAABxZJREFUeJzt3U2Ijf0fx/E5yEOh5JbkYWNDiRUlG8mK5LFmYzkbLAjD
wopYDckOpUixtGKhsGFjYTFFNlJKylCEkBnn3t7+/ed7NU7Hwef12n46c53w7lK/c65ptdvtPiDL
pF6/AeDXEz4EEj4EEj4EEj4EEj4EEj4EmtLtC7RaLR8UgB5ot9ut8TZ3fAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgk
fAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAg0pddvgN5aunRpuc+bN6/ct23bNu62fv36
8rVjY2PlfuHChXJ/8OBBuT979qzck7njQyDhQyDhQyDhQyDhQyDhQyDhQ6BWu93u7gVare5eINyK
FSvKfd++feW+Y8eOcv/nn38m/J5+ldHR0XJ/+vRpud+/f7/cDxw4UO7fvn0r915rt9ut8TZ3fAgk
fAgkfAgkfAgkfAgkfAgkfAjk+/g9tnLlynLfu3dvuff395f77NmzJ/ye/uvly5flXp2FP3/+vHzt
4OBguT969KjcV69eXe5z584t982bN5f78PBwuTc9L+B35o4PgYQPgYQPgYQPgYQPgYQPgYQPgXwf
v8vOnz9f7tu3by/3Tr8Pf/fu3XJvOqs+duxYuX/58mXcrdUa9+vgfX19fX137twp96ZnCVy6dKnc
V61aVe6vX78u90WLFpX7ggULyv3Nmzfl3m2+jw/8QPgQSPgQSPgQSPgQSPgQSPgQyPfxG0yfPr3c
jxw5Uu4DAwPl3nTWPTIyUu5NnxMYGhoq90+fPpV7J5o+I9L0fflJk+r70vHjx8v91q1b5b5kyZJy
/5u540Mg4UMg4UMg4UMg4UMg4UMg4UMg5/gN1q9fX+6HDx8u96Zz+qbn1u/atavcHz58WO7dNnny
5HG3xYsXl6+9evVqud+8ebPc58yZU+5Nf/ZNmt7f+/fvO/r5veSOD4GED4GED4GED4GED4GED4GE
D4Gc4zeozqn7+vr6vn//3tHPHx0dLfc1a9aU+86dO8t92bJlE35P//X58+dyX758+U9tfX3Nz52f
P39+uTdpeh5A03P1T506Ve7fvn2b8Hv6XbjjQyDhQyDhQyDhQyDhQyDhQyDhQ6BW01lnxxdotbp7
gS6bMWNGuV+7dq3cN27c2NHPb3q2fKd/f2NjY+Xe9DmGXmr6DMWNGzfKff/+/eX+6tWrCb+n30m7
3R73gQTu+BBI+BBI+BBI+BBI+BBI+BBI+BDIOX6XNT37/ejRo+W+bt26cn/79m25v3jxotynTZtW
7qtWrSr3pucFdKLp3+b58+fL/dixY+X+7t27Cb+nP4lzfOAHwodAwodAwodAwodAwodAwodAzvHD
Nf0O+StXrpT77t27x92a/m19+PCh3A8dOlTuly9fLvemZw387ZzjAz8QPgQSPgQSPgQSPgQSPgQS
PgSa0us3QG8NDg6We39/f9euvWfPnnK/fv16166dzh0fAgkfAgkfAgkfAgkfAgkfAgkfAvk+/l9u
YGCg3M+cOVPuM2fO/OlrP378uNxXr15d7l+/fv3pa+P7+MD/ED4EEj4EEj4EEj4EEj4EEj4Eco7/
h2v6/fS3b98u91mzZnV0/Y8fP467bdq0qXztgwcPOro2Nef4wA+ED4GED4GED4GED4GED4GED4E8
V/8Pt2XLlnLv9Jz+06dP5b5169ZxN+f0vy93fAgkfAgkfAgkfAgkfAgkfAgkfAjk+/i/uaZz+JGR
kXKfOnVquTf9/V+8eLHcm37HPb3j+/jAD4QPgYQPgYQPgYQPgYQPgYQPgZzj91jT759/8uRJuS9c
uLCj6w8PD5f72rVry/3Lly8dXZ/ucY4P/ED4EEj4EEj4EEj4EEj4EEj4EMhz9Xtsw4YN5b5o0aKO
fn7T5zQOHjxY7s7p/07u+BBI+BBI+BBI+BBI+BBI+BBI+BDIOX6PnThxoqPXN53TDw0Nlfu9e/c6
uj5/Jnd8CCR8CCR8CCR8CCR8CCR8CCR8COQcv8fmzp3b0etHRkbK/dy5cx39fP5O7vgQSPgQSPgQ
SPgQSPgQSPgQSPgQyDl+j509e7bcT58+Xe4nT54s91evXk34PfH3c8eHQMKHQMKHQMKHQMKHQMKH
QMKHQK2m57J3fIFWq7sXAP6vdrvdGm9zx4dAwodAwodAwodAwodAwodAv+JruY9+wTWACej6OT7w
+/FffQgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgkfAgk
fAgkfAj0L55dWFzecy4GAAAAAElFTkSuQmCC
">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Closing-remark">Closing remark<a class="anchor-link" href="#Closing-remark">&#182;</a></h2><p>In this notebook, we used <code>slim</code>, tensorflow's native high level APIs to construct a computational graph. It greatly simplified the network construction task for us. I hope it was an educational comparison between this notebook and the last MNIST tutorial notebook where we defined network layers in a pedantic way (i.e. by hand).</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>

  <div class="tag-cloud">
    <p>
      <a href="/tag/colaboratory-tensorflow-mnist-classification-slim.html">colaboratory tensorflow mnist classification slim</a>
    </p>
  </div>



</article>

    <footer>
<p>
  &copy; DeepLearnPhysics 2017 - This work is licensed under a <a rel="license" href="https://opensource.org/licenses/MIT">MIT License</a>
</p>
<p>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " DeepLearnPhysics Blog ",
  "url" : "",
  "image": "profile.png",
  "description": "description!"
}
</script>
</body>
</html>